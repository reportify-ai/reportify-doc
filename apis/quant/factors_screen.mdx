---
title: '因子选股'
description: '基于因子公式筛选股票'
openapi: 'POST /v1/quant/factors/screen'
---

基于因子公式筛选股票，返回满足条件的股票列表。支持技术因子和基本面因子组合筛选。

<CodeGroup>

```bash cURL
curl -X POST https://api.reportify.cn/v1/quant/factors/screen \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "market": "cn",
    "formula": "RSI(14) < 30",
    "check_date": "2026-01-08"
  }'
```

```python Python
import requests

# 全市场筛选 RSI 超卖股票
response = requests.post(
    "https://api.reportify.cn/v1/quant/factors/screen",
    headers={"Authorization": "Bearer <token>"},
    json={
        "market": "cn",
        "formula": "RSI(14) < 30",
        "check_date": "2026-01-08"
    }
)
print(response.json())
```

```typescript TypeScript
const response = await fetch('https://api.reportify.cn/v1/quant/factors/screen', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer <token>',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    market: 'cn',
    formula: 'RSI(14) < 30',
    check_date: '2026-01-08'
  })
});
```

</CodeGroup>

## 请求参数

<ParamField body="market" type="string" default="cn">
  股票市场：`cn`（A股）, `hk`（港股）, `us`（美股）
</ParamField>

<ParamField body="formula" type="string" required>
  筛选公式，返回布尔值或数值
</ParamField>

<ParamField body="check_date" type="string">
  检查日期，格式：`YYYY-MM-DD`（默认：最新交易日）
</ParamField>

<ParamField body="symbols" type="string[]">
  股票代码列表（可选，不传则为全市场筛选）
</ParamField>

## 公式示例

### 技术面筛选

| 公式 | 描述 |
|------|------|
| `RSI(14) < 30` | RSI 超卖 |
| `CROSS(MA(CLOSE, 5), MA(CLOSE, 10))` | 均线金叉（MA5 上穿 MA10） |
| `CROSSDOWN(MA(CLOSE, 5), MA(CLOSE, 10))` | 均线死叉（MA5 下穿 MA10） |
| `(CLOSE > MA(CLOSE, 20)) & (MA(CLOSE, 20) > MA(CLOSE, 60))` | 多头趋势 |
| `CLOSE > BOLL(20, 2).upper` | 突破布林带上轨 |
| `(KDJ().j < 20) & CROSS(KDJ().k, KDJ().d)` | KDJ 低位金叉 |
| `MACD().dif > MACD().dea` | MACD 多头 |
| `CLOSE > REF(CLOSE, 1) * 1.05` | 较昨日涨幅超 5% |
| `CLOSE > HHV(HIGH, 20)` | 创 20 日新高 |
| `COUNT(CLOSE > REF(CLOSE, 1), 5) >= 4` | 近 5 日至少 4 天上涨 |
| `EVERY(CLOSE > REF(CLOSE, 1), 3)` | 连续 3 天上涨 |
| `(CLOSE > MA(CLOSE, 10)) & (MA(CLOSE, 10) > MA(CLOSE, 20)) & (MA(CLOSE, 20) > MA(CLOSE, 60))` | 多均线多头排列 |
| `(MA(CLOSE, 10) > REF(MA(CLOSE, 10), 5)) & (MA(CLOSE, 20) > REF(MA(CLOSE, 20), 5))` | 均线向上发散 |
| `VOLUME > MA(VOLUME, 20) * 2` | 成交量放大（2 倍于 20 日均量） |

### 基本面筛选

| 公式 | 描述 |
|------|------|
| `PE() < 15` | 低市盈率 |
| `PE_TTM() < 20` | 市盈率（TTM）低于 20 |
| `PB() < 1` | 破净股（市净率低于 1） |
| `ROE() > 0.15` | ROE 大于 15% |
| `(PE() < 20) & (ROE() > 0.1)` | 价值 + 质量 |
| `(PE_TTM() < 15) & (PB() < 2) & (ROE() > 0.12)` | 多因子价值筛选 |
| `REVENUE_GROWTH_RATE() > 0.2` | 营收增长率大于 20% |
| `NET_PROFIT_GROWTH_RATE() > 0.3` | 净利润增长率大于 30% |
| `CURRENT_RATIO() > 2` | 流动性充足 |
| `DEBT_TO_EQUITY_RATIO() < 0.5` | 低杠杆 |
| `GPM() > 0.3` | 毛利率大于 30% |

### 技术面 + 基本面组合

| 公式 | 描述 |
|------|------|
| `(PE() < 20) & (RSI(14) < 40)` | 便宜 + 超卖 |
| `(ROE() > 0.12) & (CLOSE > MA(CLOSE, 20))` | 质量 + 上涨趋势 |
| `(PB() < 1.5) & CROSS(MA(CLOSE, 5), MA(CLOSE, 20))` | 价值 + 金叉 |

## 运算符

| 类型 | 运算符 | 说明 |
|------|--------|------|
| 比较 | `>`, `<`, `>=`, `<=`, `==`, `!=` | 数值比较 |
| 逻辑与 | `&` | 注意：不是 `AND` |
| 逻辑或 | `\|` | 注意：不是 `OR` |
| 算术 | `+`, `-`, `*`, `/` | 四则运算 |

## 支持的变量

| 变量 | 别名 | 描述 |
|------|------|------|
| `CLOSE` | `C` | 收盘价 |
| `OPEN` | `O` | 开盘价 |
| `HIGH` | `H` | 最高价 |
| `LOW` | `L` | 最低价 |
| `VOLUME` | `V`, `VOL` | 成交量 |

## 支持的函数

| 级别 | 函数 |
|------|------|
| Level 0 | `MA`, `EMA`, `SMA`, `REF`, `HHV`, `LLV`, `STD`, `SUM`, `ABS`, `MAX`, `MIN`, `IF`... |
| Level 1 | `CROSS`, `CROSSDOWN`, `COUNT`, `EVERY`, `EXIST`, `BARSLAST`... |
| Level 2 技术 | `RSI`, `MACD`, `BOLL`, `KDJ`, `WR`, `ATR`, `CCI`, `BIAS`, `PSY`... |
| Level 2 基本面 | `PE()`, `PB()`, `PS()`, `ROE()`, `ROA()`, `EPS()`, `BPS()`, `CURRENT_RATIO()`... |

## 响应参数

<ResponseField name="datas" type="ScreenedStock[]">
  通过筛选的股票列表
  <Expandable title="ScreenedStock 字段">
    <ResponseField name="symbol" type="string">
      股票代码
    </ResponseField>
    <ResponseField name="close" type="number">
      检查日收盘价
    </ResponseField>
    <ResponseField name="factor_value" type="number | boolean">
      因子值（如适用）
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="metadata" type="object">
  筛选元数据
</ResponseField>

## 响应示例

### 全市场筛选

```json
{
  "datas": [
    {
      "symbol": "000001",
      "close": 12.35,
      "factor_value": 28.5
    },
    {
      "symbol": "002142",
      "close": 8.92,
      "factor_value": 25.3
    },
    {
      "symbol": "600036",
      "close": 35.68,
      "factor_value": 29.8
    }
  ],
  "metadata": {
    "formula": "RSI(14) < 30",
    "market": "cn",
    "check_date": "2026-01-08",
    "total_screened": 3,
    "total_universe": 5000
  }
}
```

### 指定股票池筛选

请求：

```python
response = requests.post(
    "https://api.reportify.cn/v1/quant/factors/screen",
    headers={"Authorization": "Bearer <token>"},
    json={
        "market": "cn",
        "formula": "(RSI(14) < 30) & (CLOSE > MA(CLOSE, 20))",
        "symbols": ["000001", "000002", "000003", "600519"]
    }
)
```

响应：

```json
{
  "datas": [
    {
      "symbol": "000001",
      "close": 12.35,
      "factor_value": true
    }
  ],
  "metadata": {
    "formula": "(RSI(14) < 30) & (CLOSE > MA(CLOSE, 20))",
    "market": "cn",
    "check_date": "2026-01-10",
    "total_screened": 1,
    "total_universe": 4
  }
}
```
